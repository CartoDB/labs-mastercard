<!DOCTYPE html>
<html>
  <head>
    <title>Mastercard</title>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
    <link rel="shortcut icon" href="http://cartodb.com/assets/favicon.ico" />
    <link href='http://fonts.googleapis.com/css?family=Istok+Web' rel='stylesheet' type='text/css'>
    <link href='reset.css' rel='stylesheet' type='text/css'>
    <link href='app.css' rel='stylesheet' type='text/css'>
    <script src="Chart.min.js"></script>
    <link rel="stylesheet" href="http://libs.cartocdn.com/cartodb.js/v3/themes/css/cartodb.css" />
    <!--[if lte IE 8]>
        <link rel="stylesheet" href="http://libs.cartocdn.com/cartodb.js/v3/themes/css/cartodb.ie.css" />
    <![endif]-->

    <script type="cartocss/html" id="torque_template">
@dx: 6;
Map {
-torque-frame-count:182;
-torque-animation-duration:30;
-torque-time-attribute:"mdh";
-torque-aggregation-function:"avg(dif)";
-torque-resolution:6;
-torque-data-aggregation:linear;
}
#mastercard_dh{
  marker-fill-opacity: 1;
  marker-line-color: #070707;
  marker-line-width: 0.8;
  marker-line-opacity: 0.8;
  marker-type: ellipse;
  marker-width: @dx;
  marker-fill: #3E7BB6;
    [value=1]{marker-width: 1+@dx}
    [value=2]{marker-width: 2+@dx}
    [value=3]{marker-width: 4+@dx}
    [value=4]{marker-width: 6+@dx}

    [value=11]{marker-width: 1+@dx}
    [value=12]{marker-width: 2+@dx}
    [value=13]{marker-width: 4+@dx}
    [value=14]{marker-width: 6+@dx}

    [value=21]{marker-width: 1+@dx}
    [value=22]{marker-width: 2+@dx}
    [value=23]{marker-width: 4+@dx}
    [value=24]{marker-width: 6+@dx}
  
    [value=31]{marker-width: 1+@dx}
    [value=32]{marker-width: 2+@dx}
    [value=33]{marker-width: 4+@dx}
    [value=34]{marker-width: 6+@dx}

  [value>=40]{
   marker-fill: #636161;
    [value=41]{marker-width: 1+@dx}
    [value=42]{marker-width: 2+@dx}
    [value=43]{marker-width: 4+@dx}
    [value=44]{marker-width: 6+@dx}
  }
  [value>=50]{
   marker-fill: #B81609;
    [value=51]{marker-width: 1+@dx}
    [value=52]{marker-width: 2+@dx}
    [value=53]{marker-width: 4+@dx}
    [value=54]{marker-width: 6+@dx}
  
    [value=61]{marker-width: 1+@dx}
    [value=62]{marker-width: 2+@dx}
    [value=63]{marker-width: 4+@dx}
    [value=64]{marker-width: 6+@dx}

    [value=71]{marker-width: 1+@dx}
    [value=72]{marker-width: 2+@dx}
    [value=73]{marker-width: 4+@dx}
    [value=74]{marker-width: 6+@dx}
  }
  marker-comp-op: screen;
}
    </script>
  </head>
  <body>
    <div class="title-container">
      <div class="title">
        <div id="back" class="hide"></div>
        <div class="title-txt">
          <h1>Local Commerce x Global Scale</h1>
          <h2>A partnership between Mastercard and CartoDB</h2>
        </div>
      </div>
      <div class="title-decoration">&nbsp;</div>
    </div>
    

    
    <div id="map"></div>

    <!-- include cartodb.js library -->
    <script src="http://libs.cartocdn.com/cartodb.js/v3/3.12/cartodb.js"></script>

    <script>
      function main() {
        var centerD = [42.338, -71.153];
        var zoomD = 10;

        var map = L.map('map', { 
          center: centerD,
          zoom: zoomD
        })

        L.tileLayer('http://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}.png',{
          attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, &copy; <a href="http://cartodb.com/attributions">CartoDB</a>'
        }).addTo(map);

        cartodb.createLayer(map, {
          type: "torque",
          order: 1,
          options: {
            query: "",
            table_name: "mastercard_dh",
            user_name: "ashmurali",
            tile_style: $('#torque_template').html()
          }
        })      
        .addTo(map)  
        .done(function(layer) {
          $('.cartodb-timeslider').css({'left': 'auto','right':'20px'})
        })
        .error(function(err) {
          console.log(err);
        });
      }

      window.onload = main;
    </script>
    <style>
      .cartodb-timeslider {
        right: 20px;
        left: auto;
      }
    </style>
  </body>
</html>